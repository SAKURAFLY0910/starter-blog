---
title: 'typecho网站迁移注意事项'
date: '2022-08-02 00:24'
tags: ['Blog', 'Typecho', 'theme']
draft: false
layout: PostLayout
summary: 'typecho网站迁移注意事项'
---

#### 修改config.inc.php文件


　　在宝塔控制面板新建网站(同时勾选新建数据库，数据库名可以与旧的不一样)之后，将旧的网站文件全部复制到网站目录下，然后将数据库SQL还原。

```PHP
## 数据库类型使用 Pdo_Mysql ; view 指数据库前缀 默认typcho_
$db = new Typecho_Db('Pdo_Mysql', 'view');

## 修改为新建的数据库名，注意数据库权限密码
'database' => 'lover', 

```


#### PHP版本



PHP版本注意和原网站版本保持一致。80以上版本好像会出错，70版本也会报**Database Query Error**,我常用的74版本即可



#### MySql版本和数据库权限



MySql版本太高也会出错，最好和原网站版本保持一致，否则数据库还原也会有问题。一般使用5.7版本即可。数据库权限使用宝塔管理较为方便。



#### 修改网站地址

是复制过去的，网站的地址还是原网站域名地址访问，导致所有的css、js文件都是通过原网站域名访问的，这就会出问题导致页面渲染出错。在勉强可以登录typecho管理后台之后，修改**设置-->基本-->站点地址**。


#### 强制https



添加证书之后，https访问但是所请求的css、js文件都是http协议导致加载文件失败，界面渲染不完整。这时候可以在config.inc.php中添加以下配置使请求静态文件使用https协议
```PHP
## 强制Https
define('__TYPECHO_SECURE__', true);
```

#### 网站路径
网站路径禁用中文，这是有血的教训的


#### /web_config/php.config文件中PHP的安装位置修改
迁移网站时有可能两台服务器之间,宝塔安装的位置不同导致下载的PHP在不同的路径下，这时候就必须修改为宝塔下正确的路径; 如果没有使用宝塔管理，参照原来的网站找到PHP的位置，然后修改路径即可
```config
<?xml version="1.0" ?>
<handlers>
	<remove name="php_52"/>
	<remove name="php_53"/>
	<remove name="php_54"/>
	<remove name="php_55"/>
	<remove name="php_56"/>
	<remove name="php_70"/>
	<remove name="php_71"/>
	<remove name="php_72"/>
	<remove name="php_73"/>
	<remove name="php_74"/>
	<remove name="php_75"/>
	<remove name="php_00"/>
	<remove name="php_80"/>
	<remove name="php_81"/>
	<remove name="php_82"/>
	<add name="php_70" path="*.php" verb="*" modules="FastCgiModule" scriptProcessor="D:\SAKURA\BT\BtSoft\php\70\php-cgi.exe" resourceType="File" requireAccess="Script"/>
</handlers>

```






