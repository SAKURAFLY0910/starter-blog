---
title: 'package.json文件'
date: '2022-08-13 19:10'
tags: ['Web', 'package.json', 'npm']
draft: false
layout: PostLayout
summary: 'package.json文件配置'
---

##### scripts字段


scripts指定了运行脚本命令的npm命令行缩写，比如start指定了运行npm run start时，所要执行的命令。



下面的设置指定了npm run preinstall、npm run postinstall、npm run start、npm run test时，所要执行的命令。
```json
"scripts": {
    "preinstall": "echo here it comes!",
    "postinstall": "echo there it goes!",
    "start": "node index.js",
    "test": "tap test/*.js"
}
```


##### dependencies字段，devDependencies字段


dependencies字段指定了项目运行所依赖的模块，devDependencies指定项目开发所需要的模块。
它们都指向一个对象。该对象的各个成员，分别由模块名和对应的版本要求组成，表示依赖的模块及其版本范围。

```json
{
  "devDependencies": {
    "browserify": "~13.0.0",
    "karma-browserify": "~5.0.1"
  }
}
```

* 对应的版本可以加上各种限定，主要有以下几种：
  * **指定版本**：比如1.2.2，遵循“大版本.次要版本.小版本”的格式规定，安装时只安装指定版本。
  * **波浪号（tilde）+指定版本**：比如~1.2.2，表示安装1.2.x的最新版本（不低于1.2.2），但是不安装1.3.x，也就是说安装时不改变大版本号和次要版本号。
  * **插入号（caret）+指定版本**：比如ˆ1.2.2，表示安装1.x.x的最新版本（不低于1.2.2），但是不安装2.x.x，也就是说安装时不改变大版本号。需要注意的是，如果大版本号为0，则插入号的行为与波浪号相同，这是因为此时处于开发阶段，即使是次要版本号变动，也可能带来程序的不兼容。
  * **latest**：安装最新版本。



package.json文件可以手工编写，也可以使用npm init命令自动生成。
```json
$ npm init 

$ npm init -y
```
有了package.json文件，直接使用npm install命令，就会在当前目录中安装所需要的模块。
```json
$ npm install
```
如果一个模块不在package.json文件之中，可以单独安装这个模块，并使用相应的参数，将其写入package.json文件之中。
```json
# 安装到生产环境(dependencies节点)
$ npm install express --save
$ npm install express -S

# 安装到开发环境(devDependencies)
$ npm install express --save-dev
$ npm install express -D
```  



##### bin字段

bin项用来指定各个内部命令对应的可执行文件的位置。
```node
"bin": {
  "someTool": "./bin/someTool.js"
}
```
上面代码指定，someTool 命令对应的可执行文件为 bin 子目录下的 someTool.js。Npm会寻找这个文件，在node_modules/.bin/目录下建立符号链接。在上面的例子中，someTool.js会建立符号链接node_modules/.bin/someTool。由于node_modules/.bin/目录会在运行时加入系统的PATH变量，因此在运行npm时，就可以不带路径，直接通过命令来调用这些脚本。   
 
因此，像下面这样的写法可以采用简写。
```node
scripts: {  
  start: './node_modules/bin/someTool.js build'
}

// 简写为

scripts: {  
  start: 'someTool build'
}

```
所有node_modules/.bin/目录下的命令，都可以用npm run [命令]的格式运行。在命令行下，键入npm run，然后按tab键，就会显示所有可以使用的命令。


##### main字段


main字段指定了加载的入口文件，require('moduleName')就会加载这个文件。这个字段的默认值是模块根目录下面的index.js。


##### config 字段


config字段用于添加命令行的环境变量。
```npm
{
  "name" : "foo",
  "config" : { "port" : "8080" },
  "scripts" : { "start" : "node server.js" }
}
```
然后，在server.js脚本就可以引用config字段的值。
```node
http
  .createServer(...)
  .listen(process.env.npm_package_config_port)
```











