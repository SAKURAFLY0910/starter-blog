---
title: '10. SQLServer : 表达式'
date: '2022-10-05 21:03'
tags: ['SQLServer', '数据库', '表达式']
draft: false
layout: PostLayout
summary: '表达式是由常量、变量、列名、运算符和函数组成的公式，用于计算或生成特定值。它可用于SELECT查询、WHERE条件、ORDER BY等几乎所有SQL语句中，实现数据筛选、计算和转换。表达式类型包括标量（返回单个值）、布尔（返回TRUE/FALSE）和表值（返回结果集）'
---

### 表达式的类型

```SQL
-- 语法
--Simple CASE expression:   
CASE input_expression   
     WHEN when_expression THEN result_expression [ ...n ]   
     [ ELSE else_result_expression ]   
END   

--Searched CASE expression:  
CASE  
     WHEN Boolean_expression THEN result_expression [ ...n ]   
     [ ELSE else_result_expression ]   
END  

-- 示例一
SELECT   ProductNumber, Category =  
      CASE ProductLine  
         WHEN 'R' THEN 'Road'  
         WHEN 'M' THEN 'Mountain'  
         WHEN 'T' THEN 'Touring'  
         WHEN 'S' THEN 'Other sale items'  
         ELSE 'Not for sale'  
      END,  
   Name  
FROM Production.Product  
ORDER BY ProductNumber;  
GO  


--示例二
SELECT   ProductNumber, Name, "Price Range" =   
      CASE   
         WHEN ListPrice =  0 THEN 'Mfg item - not for resale'  
         WHEN ListPrice < 50 THEN 'Under $50'  
         WHEN ListPrice >= 50 and ListPrice < 250 THEN 'Under $250'  
         WHEN ListPrice >= 250 and ListPrice < 1000 THEN 'Under $1000'  
         ELSE 'Over $1000'  
      END  
FROM Production.Product  
ORDER BY ProductNumber ;  
```


